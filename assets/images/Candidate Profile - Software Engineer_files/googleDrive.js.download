const ICIMS_GOOGLE_SCOPES="https://www.googleapis.com/auth/drive";let icims_fileElem=null;let icims_googleAccessToken=null;let icims_isImage=false;function icims_newGoogleDrivePicker(b,a,c){icims_googleAccessToken=b;icims_fileElem=a;icims_isImage=c;gapi.load("picker",{callback:icims_createGoogleDrivePicker})}function icims_createGoogleDrivePicker(){var b=new google.picker.DocsView(google.picker.ViewId.DOCS);if(icims_isImage){b.setMode(google.picker.DocsViewMode.GRID)}else{b.setMode(google.picker.DocsViewMode.LIST)}var a=document.getElementById(icims_fileElem+"_File").getAttribute("validTypes");if(a.indexOf("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")>0){a=a+",application/vnd.google-apps.spreadsheet"}if(a.indexOf("application/vnd.openxmlformats-officedocument.wordprocessingml.document")>0||a.indexOf("application/pdf")>0){a=a+",application/vnd.google-apps.kix,application/vnd.google-apps.document"}b.setMimeTypes(a);var d=document.documentElement.clientWidth-20;var c=new google.picker.PickerBuilder().enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MINE_ONLY).setAppId(ICIMS_GOOGLE_CLIENT_ID).addView(b).setSize(d).setLocale(icims_googlePickerLocale).setCallback(icims_googlePickerCallback).setOAuthToken(icims_googleAccessToken).build();c.setVisible(true)}function icims_googlePickerCallback(b){if(b[google.picker.Response.ACTION]===google.picker.Action.PICKED){const d=b[google.picker.Response.DOCUMENTS][0];icims_handleGoogleDriveFileSelection(d[google.picker.Document.ID],d.resourceKey)}if(b[google.picker.Response.ACTION]===google.picker.Action.PICKED||b[google.picker.Response.ACTION]===google.picker.Action.CANCEL){try{const a=$("[id='"+icims_fileElem+"_UploadButtons']").position();$(window.parent).scrollTop(a.top)}catch(c){}}}function icims_handleGoogleDriveFileSelection(a,b){const d={path:"/drive/v2/files/"+a,method:"GET",headers:{Authorization:"Bearer "+icims_googleAccessToken},params:{maxResults:"1"}};if(b!==undefined){d.headers["X-Goog-Drive-Resource-Keys"]=a+"/"+b}const c=gapi.client.request(d);c.execute(handleResponse)}function handleResponse(a){if(!a.error){const b=getUrlAndFilenameFromResponse(a);icims_setFileFieldValueFromUrl(icims_fileElem,b.filename,b.downloadUrl,a.thumbnailLink,"googleDrive")}else{alert(resourceBundle.get("googleDrive.js.errorMsg_1",{msg:a.error.message}))}}function getUrlAndFilenameFromResponse(b){let downloadUrl=b.downloadUrl;let filename=b.title;if(downloadUrl===undefined||downloadUrl===null){const a=document.getElementById(icims_fileElem+"_File").getAttribute("validTypes");let extension="";if(b.mimeType==="application/vnd.google-apps.document"&&a.includes("application/vnd.openxmlformats-officedocument.wordprocessingml.document")>0){downloadUrl=b.exportLinks["application/vnd.openxmlformats-officedocument.wordprocessingml.document"];downloadUrl+="&mimeType=application/vnd.openxmlformats-officedocument.wordprocessingml.document";extension=".docx"}else{if(b.mimeType==="application/vnd.google-apps.spreadsheet"&&a.includes("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")>0){downloadUrl=b.exportLinks["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];downloadUrl+="&mimeType=application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";extension=".xlsx"}else{downloadUrl=b.exportLinks["application/pdf"];downloadUrl+="&mimeType=application/pdf";extension=".pdf"}}filename=filename+extension}if(icims_googleAccessToken!=null){downloadUrl+="&access_token="+icims_googleAccessToken}if(b.id!=null){downloadUrl+="&id="+b.id}if(b.resourceKey){downloadUrl+="&resourceKey="+b.resourceKey}return{downloadUrl:downloadUrl,filename:filename}}if(typeof exports!=="undefined"){module.exports={icims_newGoogleDrivePicker:icims_newGoogleDrivePicker,handleResponse:handleResponse,icims_googlePickerCallback:icims_googlePickerCallback}};